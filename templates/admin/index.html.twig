{% extends 'base.html.twig' %}

{% block title %}Espace Admin{% endblock %}

{% block body %}
<h1>Espace Admin — Gestion des demandes PO</h1>

{% if message %}
    <div style="background-color:#ddf; padding:10px; margin-bottom:10px;">
        {{ message|raw }}
    </div>
{% endif %}

{# Sélection de la demande PO #}
<form method="get" action="{{ path('app_admin') }}">
    <label><strong>Demandes du Product Owner :</strong></label>
    <select name="request_id" onchange="this.form.submit()">
        <option value="">-- Sélectionner une demande --</option>
        {% for req in requests %}
            <option value="{{ req.id }}"
                {% if selected and selected.id == req.id %}selected{% endif %}
            >
                {{ req.username }} — {{ req.action.value }}
            </option>
        {% endfor %}
    </select>
</form>

<hr>

{# Formulaire de création du compte client pour la demande sélectionnée #}
{% if selected %}
<form method="post">
    <input type="hidden" name="request_id" value="{{ selected.id }}">

    <label>Username :</label><br>
    <input type="text" name="username" value="{{ selected.username }}" required><br><br>

    <label>Password :</label><br>
    <input type="password" name="password" value="{{ selected.password }}" required><br><br>

    <label>Action :</label><br>
    <input type="text" name="action" value="{{ selected.action.value }}" readonly><br><br>

    <label>Status :</label><br>
    <input type="text" name="status" value="{{ selected.status.value }}" readonly><br><br>

    <button type="submit">Créer le compte</button>
</form>
{% endif %}

{% endblock %}
